<!DOCTYPE html>
<html lang="en">

	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no">
		<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
		<meta http-equiv="Pragma" content="no-cache" />
		<meta http-equiv="Expires" content="0" />
		<title>蓝联退税</title>
		<link rel="stylesheet" href="css/index.css" />
		<script type="text/javascript" src="js/jquery.min.js"></script>
	</head>

	<body>
		<div id="openId" style="display:none;" th:text="${session.openId}"></div>
		<div id="sessionKey" style="display:none;" th:text="${session.sessionKey}"></div>
		<script type="text/javascript" src="js/login.js"></script>
		<script type="text/javascript">
			$(document).ready(function() {
				/*openId('otQ261cenuncZj95ajhU6NOJHi12');*/
				console.log($("#openId").html());
			});
		</script>
		<div id="headimgurlText" style="display:none;" th:text="${session.headImgUrl}"></div>
		<div id="wrap2">
			<div class="header">
				<div class="nameInformation">
					<div class="nameInformation1">
						<img src="img/test.jpg" class="nameInformation11" />
					</div>
					<ul class="nameInformation2">
						<li class="name1" th:text="${session.nickName}"></li>
						<li class="name2" id="name2">
							<!--<img src="img/componySmall.png"/>
							<span>上海张三丰科技有限公司aaaaaaa</span>-->
						</li>
					</ul>
					<div class="nameInformation3">
						<img src="img/design.png" />
					</div>
				</div>
				<div class="renZheng">
					<div class="renZheng1">
						<img class="renZhengPic" src="img/renZheng.png" />
						<ul>
							<li class="renzhengBig">未认证</li>
							<li class="renzhengSmall">
								<span class="renzhengSmall1"></span>
								<span class="renzhengSmall2">安全退税</span>
							</li>
						</ul>
					</div>
					<div class="renZheng2">
						<p class="renZheng2Big">花少量时间，保护您的最大权益</p>
						<p class="renZheng2Small">赶紧去申请企业认证>></p>
					</div>
					<div class="renZheng3">企业认证</div>
				</div>
				<div class="yiRenZheng">
					<div class="renZheng1">
						<img class="renZheng1Pic" src="img/renZheng2.png" />
						<ul>
							<li class="renzhengBig">已认证</li>
							<li class="renzhengSmall">
								<span class="renzhengSmall1"></span>
								<span class="renzhengSmall2">安全退税</span>
							</li>
						</ul>
					</div>
					<div class="renZheng2">
						<p class="renZheng2Big">花少量时间，保护您的最大权益</p>
						<p class="renZheng2Small">尊贵的企业用户您好>></p>
					</div>
					<div class="renZheng3">添加银行账户</div>
				</div>
				<div class="yiRenZheng2">
					<div class="renZheng1">
						<img class="renZheng1Pic" src="img/renZheng2.png" />
						<ul>
							<li class="renzhengBig">已认证</li>
							<li class="renzhengSmall">
								<span class="renzhengSmall1"></span>
								<span class="renzhengSmall2">安全退税</span>
							</li>
						</ul>
					</div>
					<div class="renZheng2">
						<p class="renZheng2Big">花少量时间，保护您的最大权益</p>
						<p class="renZheng2Small">尊贵的企业用户您好>></p>
					</div>
					<div class="renZheng3">查看银行账户</div>
				</div>
			</div>
			<div class="content">
				<div class="invoice">
					<div class="invoiceTop">
						<img src="img/new.png" />
						<p>发票信息</p>
					</div>
					<div class="invoiceBox" id="invoiceBox">
						<div class="invoiceLeft">
							<p>0</p>
							<p>上传发票数</p>
						</div>
						<ul class="invoiceMiddle">
							<li></li>
							<li></li>
							<li></li>
							<li></li>
							<li></li>
							<li></li>
						</ul>
						<div class="invoiceRight">
							<p>0</p>
							<p>可退发票数</p>
						</div>
					</div>
				</div>
				<div class="invoice">
					<div class="invoiceTop">
						<img src="img/new.png" />
						<p>订单信息</p>
					</div>
					<div class="invoiceBox" id="orderBox">
						<div class="invoiceLeft">
							<p>0</p>
							<p>退税订单数</p>
						</div>
						<ul class="invoiceMiddle">
							<li></li>
							<li></li>
							<li></li>
							<li></li>
							<li></li>
							<li></li>
						</ul>
						<div class="invoiceRight">
							<p>0</p>
							<p>进行订单数</p>
						</div>
					</div>
				</div>
				<div class="helpBox">
					<div class="helpLeft">
						<img src="img/help.png" />
						<ul>
							<li>常见问题</li>
							<li>
								<div></div>
								<p>问题答疑</p>
							</li>
						</ul>
					</div>
					<ul class="helpMiddle">
						<li></li>
						<li></li>
						<li></li>
						<li></li>
						<li></li>
						<li></li>
						<li></li>
						<li></li>
						<li></li>
						<li></li>
					</ul>
					<div class="helpRight">
						<img src="img/contain.png" />
						<ul>
							<li>联系客服</li>
							<li>
								<div></div>
								<p>人工咨询</p>
							</li>
						</ul>
					</div>
				</div>
				<div style="width: 100%;height: 60px;"></div>
			</div>
			<div class="footer" id="footer">
				<div class="footer1">
					<img src="img/index.png" />
					<p>主页</p>
				</div>
				<div class="footer2">
					<img src="img/tax.png" />
					<p>退税</p>
				</div>
				<div class="footer3">
					<img src="img/mine2.png" />
					<p class="active9">个人中心</p>
				</div>
			</div>
			<div id="maskBox">
				<div class="phoneBox">
					<ul class="email">
						<li class="maskBig">确认手机号</li>
						<li class="maskSmall">请确认这个手机号我们可以联系到您</li>
						<li class="maskInput"><input type="text" value="" /></li>
						<li class="maskBtn">
							<div class="maskBtn1">确认</div>
							<div class="maskBtn2">取消</div>
						</li>
					</ul>
				</div>
				<div class="custerBox">
					<ul class="email">
						<li class="maskBig">联系客服</li>
						<li class="maskSmall">稍候会有客服联系您</li>
						<li class="maskSmall">请保持电话畅通</li>
						<li class="maskBtn">
							<div class="maskBtn1">确定</div>
						</li>
					</ul>
				</div>
				<div class="bankBox">
					<p class="bankBoxHeader">添加银行账户</p>
					<p class="bankBoxHeader1">请确认银行账户安全入账</p>
					<ul id="bankName2">
						<li>
							<p>选择银行：</p>
							<select id="selectBankList2">
								<option value="1">中国工商银行</option>
								<option value="2">中国农业银行</option>
								<option value="3">中国银行</option>
								<option value="4">中国建设银行</option>
								<option value="5">交通银行</option>
								<option value="6">中国邮政储蓄银行</option>
								<option value="7">中国民生银行</option>
								<option value="8">招商银行</option>
							</select>
						</li>
						<li>
							<p>开户行：</p>
							<input placeholder="请填写银行开户行" id="bankCode2" />
						</li>
						<li>
							<p>企业账户：</p>
							<input placeholder="请填写企业账户" id="bankAccount2" />
						</li>
						<li>
							<p>用户名：</p>
							<input placeholder="用户名自动获取" id="bankUserName2" readonly="readonly"/>
						</li>
					</ul>
					<div class="bankBtn2">
						<div class="bankBoxBtn1">确定</div>
						<div class="bankBoxBtn2">取消</div>
					</div>
				</div>
				<div class="bankBox2">
					<p class="bankBoxHeader">银行账户</p>
					<p class="bankBoxHeader1">请确认银行账户安全入账</p>
					<ul id="bankName3">
						<li>
							<p>选择银行：</p>
							<select id="selectBankList3">
								<option value="1">中国工商银行</option>
								<option value="2">中国农业银行</option>
								<option value="3">中国银行</option>
								<option value="4">中国建设银行</option>
								<option value="5">交通银行</option>
								<option value="6">中国邮政储蓄银行</option>
								<option value="7">中国民生银行</option>
							</select>
						</li>
						<li>
							<p>开户行：</p>
							<input placeholder="请填写银行开户行" id="bankCode3" />
						</li>
						<li>
							<p>企业账户：</p>
							<input placeholder="请填写企业账户" id="bankAccount3" />
						</li>
						<li>
							<p>用户名：</p>
							<input placeholder="用户名自动获取" id="bankUserName3" />
						</li>
					</ul>
					<div class="bankBtn3">
						<div class="bankBoxBtn1">修改</div>
						<div class="bankBoxBtn2">取消</div>
					</div>
				</div>
				<div class="bankSuccess">
					<ul class="email">
						<li class="maskBig">添加成功</li>
						<li class="maskSmall">企业银行账户添加成功</li>
						<li class="maskBtn">
							<div class="maskBtn1">确定</div>
						</li>
					</ul>
				</div>
				<div class="bankError">
					<ul class="email">
						<li class="maskBig">添加失败</li>
						<li class="maskSmall">请重新添加银行信息</li>
						<li class="maskBtn">
							<div class="maskBtn1">重新添加</div>
						</li>
					</ul>
				</div>
			</div>
		</div>
		<script type="text/javascript" src="js/xiaoli.js"></script>
		<script type="text/javascript" src="js/dali.js"></script>
		<script>
			$(document).ready(function() {
				var img = $("#headimgurlText").html();
				$(".nameInformation11").attr('src', img);
				//login();
				var data = userDetail();
				console.log(data);
				if(data.code == 200) {
					var secondData = data.data;
					if(secondData.status == -1 || secondData.status == 1 || secondData.status == 3 || secondData.status == 0) {
						$("#wrap2 .renZheng").css("display", "block");
						$("#wrap2 .yiRenZheng").css("display", "none");
						$("#wrap2 .yiRenZheng2").css("display", "none");
						$("#footer .footer3").bind("click", function() {
							window.location.href = localhost + '/mine2'; //"mine2.html";
						})
					}
					if(secondData.status == 2) {
						$("#wrap2 .renZheng").css("display", "none");
						$("#wrap2 .yiRenZheng").css("display", "block");
						var bankAccount = bankAccountDefault();
						if(bankAccount.bankId !== "" && bankAccount.bankId !== 0) {
							$("#wrap2 .renZheng").css("display", "none");
							$("#wrap2 .yiRenZheng").css("display", "none");
							$("#wrap2 .yiRenZheng2").css("display", "block");

						} else {
							$("#wrap2 .renZheng").css("display", "none");
							$("#wrap2 .yiRenZheng").css("display", "block");
							$("#wrap2 .yiRenZheng2").css("display", "none");
							$(".yiRenZheng2 .renZheng3").bind("click", function() {
								$("#maskBox").css("display", "block");
								$("#maskBox .bankBox2").css("display", "block");
							})
							$(".bankBtn2 .bankBoxBtn2").bind("click", function() {
								$("#maskBox").css("display", "none");
								$("#maskBox .bankBox2").css("display", "none");
							})
						}
						$("#footer .footer3").bind("click", function() {
							window.location.href = localhost + '/mine'; //"mine.html";
						})
					}

					/*添加银行信息*/
					$(".yiRenZheng .renZheng3").bind("click", function() {
						console.log(12);
						$("#maskBox").css("display", "block");
						$("#maskBox .bankBox").css("display", "block");
					})
					$(".bankBtn2 .bankBoxBtn2").bind("click", function() {
						$("#maskBox").css("display", "none");
						$("#maskBox .bankBox").css("display", "none");
					})
					$(".bankBtn2 .bankBoxBtn1").bind("click", function() {
						$("#loading").css("display", "block");
						var bankId = $("#selectBankList2 option:selected").val();
						var bankName = document.getElementById("bankCode2").value;
						var bankAccount = document.getElementById("bankAccount2").value;
						var bankCount = bankAccountUpdate(bankId, bankName, bankAccount);
						console.log(bankCount);
						if(bankCount.code == 200) {
							$("#maskBox").css("display", "block");
							$("#maskBox .bankBox").css("display", "none");
							$("#maskBox .bankSuccess").css("display", "block");
							$(".bankSuccess .maskBtn1").bind("click", function() {
								$("#maskBox").css("display", "none");
								$("#maskBox .bankSuccess").css("display", "none");
								window.location.reload();
							})
						} else if(bankCount.code == 400) {
							$("#maskBox").css("display", "block");
							$("#maskBox .bankBox").css("display", "none");
							$("#maskBox .bankError").css("display", "block");
							$(".bankError .maskBtn1").bind("click", function() {
								$("#maskBox .bankError").css("display", "none");
								$("#maskBox .bankBox").css("display", "block");
							})
						}

					})

					/*修改银行信息*/
					$(".yiRenZheng2 .renZheng3").bind("click", function() {
						$("#maskBox").css("display", "block");
						$("#maskBox .bankBox2").css("display", "block");
						var bankAccount2 = bankAccountDefault();
						console.log(bankAccount2);
						var selectBankList = document.getElementById("bankName3");
						var name;
						var account;
						if(bankAccount2.code == 200) {
							$("#loading").css("display", "none");
							var bankAccount2Data = bankAccount2.data;
							if(bankAccount2Data.bankId == 0) {
								name = "请选择银行";
								bankAccount2Data.bankName = "";
							} else if(bankAccount2Data.bankId == 1) {
								name = "中国工商银行";
							} else if(bankAccount2Data.bankId == 2) {
								name = "中国农业银行";
							} else if(bankAccount2Data.bankId == 3) {
								name = "中国银行";
							} else if(bankAccount2Data.bankId == 4) {
								name = "中国建设银行";
							} else if(bankAccount2Data.bankId == 5) {
								name = "交通银行";
							} else if(bankAccount2Data.bankId == 6) {
								name = "中国邮政储蓄银行";
							} else if(bankAccount2Data.bankId == 7) {
								name = "中国民生银行";
							} else if(bankAccount2Data.bankId == 8) {
								name = "招商银行";
							}

							if(bankAccount2Data.bankAccount == 0) {
								account = ""
							} else {
								account = bankAccount2Data.bankAccount;
							}

							selectBankList.innerHTML =
								'<li>\
								<p>选择银行：</p>\
								<select id="selectBankList3" disabled="disabled">\
									<option value="' + bankAccount2Data.bankId + '">' + name + '</option>\
									<option value="7">中国民生银行</option>\
									<option value="1">中国工商银行</option>\
									<option value="2">中国农业银行</option>\
									<option value="3">中国银行</option>\
									<option value="4">中国建设银行</option>\
									<option value="5">交通银行</option>\
									<option value="6">中国邮政储蓄银行</option>\
									<option value="8">招商银行</option>\
								</select>\
							</li>\
							<li>\
								<p>开户行：</p>\
								<input placeholder="请填写银行开户行" value="' + bankAccount2Data.bankName + '" id="bankCode3"/>\
							</li>\
							<li>\
								<p>企业账户：</p>\
								<input placeholder="请填写企业账户" value="' + account + '" id="bankAccount3"/>\
							</li>\
							<li>\
								<p>用户名：</p>\
								<input placeholder="用户名自动获取" id="bankUserName3" value="' + secondData.rawcompanyname + '" readonly="readonly"/>\
							</li>';
							if(bankAccount2Data.bankId == 0) {
								$("#selectBankList3").removeAttr("disabled");
							}
						} else {
							$("#loading").css("display", "none");
						}
					})
					$(".bankBtn3 .bankBoxBtn2").bind("click", function() {
						$("#maskBox").css("display", "none");
						$("#maskBox .bankBox2").css("display", "none");
					})
					$(".bankBtn3 .bankBoxBtn1").bind("click", function() {
						$("#loading").css("display", "block");
						var bankId = $("#selectBankList3 option:selected").val();
						var bankName = document.getElementById("bankCode3").value;
						var bankAccount = document.getElementById("bankAccount3").value;
						var bankCount = bankAccountUpdate(bankId, bankName, bankAccount);
						console.log(bankCount);
						if(bankCount.code == 200) {
							$("#maskBox").css("display", "block");
							$("#maskBox .bankBox2").css("display", "none");
							$("#maskBox .bankSuccess").css("display", "block");
							$(".bankSuccess .maskBtn1").bind("click", function() {
								$("#maskBox").css("display", "none");
								$("#maskBox .bankSuccess").css("display", "none");
								window.location.reload();
							})
						} else if(bankCount.code == 400) {
							$("#maskBox").css("display", "block");
							$("#maskBox .bankBox").css("display", "none");
							$("#maskBox .bankError").css("display", "block");
							$(".bankError .maskBtn1").bind("click", function() {
								$("#maskBox .bankError").css("display", "none");
								$("#maskBox .bankBox").css("display", "block");
							})
						}

					})

					var invoiceBox = document.getElementById("invoiceBox");
					invoiceBox.innerHTML =
						'<div class="invoiceLeft">\
						<p>' + secondData.AllInvoices + '</p>\
						<p>上传发票数</p>\
					</div>\
					<ul class="invoiceMiddle">\
						<li></li>\
						<li></li>\
						<li></li>\
						<li></li>\
						<li></li>\
						<li></li>\
					</ul>\
					<div class="invoiceRight">\
						<p>' + secondData.AllowInvoices + '</p>\
						<p>可退发票数</p>\
					</div>'

					var orderBox = document.getElementById("orderBox");
					orderBox.innerHTML =
						'<div class="invoiceLeft">\
						<p>' + secondData.EntireOrders + '</p>\
						<p>退税订单数</p>\
					</div>\
					<ul class="invoiceMiddle">\
						<li></li>\
						<li></li>\
						<li></li>\
						<li></li>\
						<li></li>\
						<li></li>\
					</ul>\
					<div class="invoiceRight">\
						<p>' + secondData.RuningOrders + '</p>\
						<p>进行订单数</p>\
					</div>'

					var name2 = document.getElementById("name2");
					name2.innerHTML =
						'<img src="img/componySmall.png"/>\
					<span>' + secondData.rawcompanyname + '</span>'
				}

				$("#footer .footer1").bind("click", function() {
					//window.location.href="index.html"
					window.location.href = localhost + '/index'; //"index.html"
				})
				$("#footer .footer2").bind("click", function() {
					window.location.href = localhost + '/tax'; //"tax.html"
				})

				$(".nameInformation .nameInformation3").bind("click", function() {
					window.location.href = localhost + '/mine1'; //"mine1.html"
				})
				$(".helpBox .helpLeft").bind("click", function() {
					window.location.href = localhost + '/helpCenter'; //"helpCenter.html";
				})
				$(".helpBox .helpRight").bind("click", function() {
					$("#maskBox").css("display", "block");
					$("#maskBox .phoneBox").css("display", "block");
				})
				$(".phoneBox .maskBtn1").bind("click", function() {
					/*$("#maskBox").css("display","block");*/
					$("#maskBox .phoneBox").css("display", "none");
					$("#maskBox .custerBox").css("display", "block");
				})
				$(".phoneBox .maskBtn2").bind("click", function() {
					$("#maskBox").css("display", "none");
					$("#maskBox .phoneBox").css("display", "none");
				})
				$(".custerBox .maskBtn1").bind("click", function() {
					$("#maskBox").css("display", "none");
					$("#maskBox .custerBox").css("display", "none");
				})
			})
		</script>
	</body>

</html>